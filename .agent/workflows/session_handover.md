---
description: セッション完了時の引き継ぎレポート（完了タスク、次回のステップ、初期化手順）を作成します。
---

> **⚠️ Trigger Warning**:
> このワークフローは、ユーザーが `/session_handover` コマンドを入力した場合、もしくは「セッションを終了してください」と明示的に指示した場合に**のみ**実行してください。AIが自発的に開始することは禁止されています。

1. **セッション状態の確認 (Review Session Status)**:
   - `git status` を確認し、作業内容が保存されているかチェックします。
   - specific command: `git status`

2. **変更のコミット (Commit Changes)**:
   - 未保存の変更がある場合、適切なコミットメッセージ（例: `feat: implement phase 7 staff management`）と共にコミットを提案・実行してください。
   - specific command: `git add . && git commit -m "..."`

3. **完了作業の要約 (Summarize Completed Work)**:
   - このセッションで実装した機能（例: Phase 4, 5, 6）を日本語で列挙します。
   - 大きな設計変更（例: 新テーブル `Appointment` 追加）があれば記述します。

4. **計画変更ログの更新 (Update Plan Changelog)** ⚠️ **必須**:
   - `docs/management/PLAN_CHANGELOG.md` に**必ず**このセッションの変更を追記してください。
   - 新しいバージョン番号（例: v1.3.1）を採番し、以下を記述:
     - **変更内容**: 実装した機能の箇条書き
     - **変更の背景 / 意思決定**: なぜその設計に至ったか（重要な議論があれば記録）
   - 小さな修正のみのセッションでも、最低限「バグ修正」「リファクタ」として記録すること。

5. **保留タスクと次のステップ (Identify Pending Tasks & Next Steps)**:
   - 次回セッションの直近の目標（例: 「予約とカルテの紐付け」「担当者設定」）を要約します。
   - specific command: `grep -r "TODO" src/` (任意: コード内メモの確認)

6. **技術的なコンテキスト (Document Technical Context)**:
   - 環境固有の要件（例: 「`prisma generate` が必要」「サーバー再起動が必要」）を記述します。
   - 一時的な修正（`@ts-ignore` 等）があれば明記します。

7. **引き継ぎメッセージの生成 (Generate Handover Message)**:
   - 以下の形式に従い、メッセージ全体を Markdown のコードブロック (markdown ... ) で囲んで出力してください。【重要】ファイルパスを出力する際は、**バッククォート (`) や一切の装飾記号を使わず**、完全なベタ書きのテキスト（例: src/App.tsx）として出力してください。Markdownのリンク形式 `[]()` も禁止です。
   - これにより、ユーザーは出力全体をコピーするだけで次回セッションへの引き継ぎ準備が完了します。
   
   - 出力フォーマット例:
     ````markdown
     ```markdown
     # 🔄 Session Handover: [チーム名/トピック]

     ## ✅ 今回の実装内容
     - [機能 1]
     - [機能 2]

     ## 🚧 次回のタスク (Phase X)
     - [タスク 1]
     - [タスク 2]

     ## 📖 ユーザー向け推奨ドキュメント (For User)
     次回セッション開始前に、以下のドキュメントに目を通すことを推奨します：
     - `docs/path/to/doc.md`: [理由]

     ## ⚠️ 技術的な注意点
     - [DB、環境変数、再起動に関するメモなど]
     
     > **システム指示 (SYSTEM INSTRUCTION)**:
     > 1. `docs/ai-host/INIT_ROUTER_TEAM_HARU.md` を読み込んでください。
     > 2. **最重要**: Routerファイル内で **「必須 (Mandatory)」** とマークされている参照リンク（ガイドライン、設計書など）を、必ず `read_url_content` または `view_file` ツールで内容を読み込んでください。
     > 3. **設計原則**: `docs/design/DESIGN_PRINCIPLES.md` を読み込み、設計判断時に参照してください。
     > 4. その他のドキュメントは、タスク実行中に必要になった時点で適宜参照してください。
     > 5. 言語: 日本語のみを使用してください（思考、応答、確認を含む）。
     > 6. **初期化完了後は、必ずユーザーからの具体的な開始指示があるまで待機してください。勝手な判断で実装タスクを開始しないでください。**
     >
     > **ユーザーの目的 (USER OBJECTIVE)**: [ここに次回のタスク概要、例: ダッシュボード改善]
     >
     > **必須チェック (MANDATORY CHECK)**: タスク完了とする前に必ず /quality_check を実行してください。
     ```
     ````