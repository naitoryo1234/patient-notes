# ページ別改善提案・機能詳細化 (Phase 9 Polish)

システム全体の完成度を高めるため、ページ単位でUI/UXおよび機能の深掘りを行います。
以下のリストに基づき、各ページを「完了」状態まで仕上げていきます。

---

## 1.  患者詳細ページ (`/patients/[id]`) [現在のフォーカス]

最も情報量が多く、運用の要となるページです。

### 1-1. プロフィール・基本情報
- [ ] **タグの視認性向上**:
    - 現状: 単なるグレーのバッジで表示。
    - 提案: システム固定のプリセット（例：特定のキーワード「重要」「注意」等は赤、「VIP」は金、その他は自動ハッシュによるパステルカラー等）を適用し、設定画面なしで視覚的なリッチさを提供する。
    - 理由: カスタム設定は有料/上位機能とするため、Base Kitでは「見栄えが良い」状態をデフォルトにする。
- [ ] **メモの表示最適化**:
    - 現状: 全文表示（長文だと圧迫する可能性）。
    - 提案: 3行程度で省略表示し、「もっと見る」で展開するようにしてレイアウト崩れを防ぐ。
- [ ] **スマホ対応（レスポンシブ）**:
    - 現状: PC向けレイアウトがベース。
    - 提案: モバイル閲覧時に、サイドバー（プロフィール）がメインコンテンツの上に配置されるか、タブ切り替えにするなどのレイアウト調整が必要か確認。

### 1-2. 施術履歴 (Clinical Records)
- [ ] **履歴の編集・削除**:
    - 現状: 閲覧のみの可能性が高い（仕様確認要）。
    - 提案: 間違えて作成したカルテの修正・削除フローがスムーズか再確認。削除ボタンの配置や権限。
- [ ] **担当者表示**:
    - 現状: 実装済みだが、アイコンなどがデフォルトのまま。
    - 提案: スタッフごとに色を変えるか、イニシャル表示などで識別しやすくする。

### 1-3. 次回予約UI (Next Appointment)
- [x] **編集・削除への導線**: 実装完了（モーダル編集＋台帳誘導）。
- [x] **入力UI**: 実装完了（5分刻みセレクトボックス）。

---

## 2.  予約台帳ページ (`/appointments`) [Next]

予約の全体像を把握し、調整する司令塔となるページです。

### 2-1. 安全性・整合性 (Must)
- [ ] **患者DB（ダブルブッキング）防止**:
    - 提案: 同一患者が同日・同時刻に重複して予約できないよう、サーバーサイドでブロックする。エラーメッセージを親切に表示する。
- [ ] **過去日予約の警告**:
    - 提案: 過去の日付に予約を入れる際、警告モーダルまたは確認ダイアログを挟む。

### 2-2. 閲覧性・操作性
- [ ] **キャンセル済み予約のフィルタリング**:
    - 提案: 「キャンセルを表示/非表示」トグルを追加し、画面をスッキリさせる。
- [ ] **時間軸の表示最適化**:
    - 提案: 早朝・深夜など診療時間外のスクロールを減らすため、初期スクロール位置を「現在の時間」または「開院時間」に合わせる。

---

## 3.  ダッシュボード / トップページ (`/`)

アプリの入り口であり、受付業務のメイン画面です。

### 3-1. 検索機能の強化 (Must)
- [ ] **診察券番号 (No.) 検索**:
    - 提案: 検索ボックスに数字を入力した場合、自動的にNo.検索を行う。受付スピード向上の重要機能。
- [ ] **検索結果のソート**:
    - 提案: 「最終来院日順」や「No.順」で並び替えられるようにし、再来患を探しやすくする。

### 3-2. 本日の予定パネル
- [ ] **自動更新 (Auto-Refresh)**:
    - 提案: 画面を開きっぱなしにしていても、「あと何分」の表示や新規予約が反映されるように、定期ポーリング（1-5分毎）を入れる。

---

## 4. ⚙️ 設定・その他

- [ ] **スタッフ1人運用モード**:
    - 提案: スタッフ選択の手間を省くための設定。
- [ ] **Global Loading UI**:
    - 提案: 画面遷移時や処理待ち時に、ユーザーを不安にさせないためのローディング表示の統一。

---
**進行ルール**:
1つのセクション（ページ）のタスクを全て消化・また見送りを決定してから、次のセクションへ進む。
