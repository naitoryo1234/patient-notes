# 🏥 実務運用シナリオ集 (Operational Scenarios)

このドキュメントは、システム実装の前に「現場の実務で発生しうる様々なパターン」を洗い出し、最適なUI/UXを設計するためのリファレンスです。
機能実装を行う際は、まずこのシナリオを確認し、仕様が実務に即しているかを検証してください。

---

## 📅 1. 予約管理 (Appointment Management)

### 1-1. 担当者未定での予約確保 (Tentative Booking)
**状況**:
- 受付で電話を受けた際、患者の希望日時だけが決まり、担当スタッフの調整は後で行いたい場合。
- または、指名がなく「空いている人」で予約を取るが、どのスタッフを割り当てるか即断できない場合。

**運用の正解**:
- **システム挙動**: 担当者（Staff）の選択を「必須」にせず、「未定（Unassigned）」の状態でも予約を完了できるようにする。
- **UI要件**:
    - 予約作成時: 担当者選択は任意（デフォルトまたは未定を選択可能）。
    - 予約一覧/ダッシュボード: 「未定」の予約は埋もれないように**赤色や警告アイコン**で目立たせ、割り当て忘れを防ぐ。
    - 編集時: 一度担当を決めた後でも、「未定」に戻せる（担当解除）ようにする。

### 1-2. 担当者の変更 (Reassignment)
**状況**:
- 担当スタッフが急病で休んだり、別の急患対応で手が離せなくなった場合。

**運用の正解**:
- **システム挙動**: 既存の予約の「担当者」だけをスムーズに変更できる。
- **重複チェック**: 変更先のスタッフがその時間に空いているか（ダブルブッキングしないか）をチェックするが、緊急時は警告を出しつつ無視できるオプション（強制割り当て）があるとさらに良い（※現Verではブロック仕様）。

### 1-4. 同日複数回利用 (Multiple Visits in a Day)
**状況**:
- 午前中に診察を受け、夕方にリハビリや別メニューで再度来院する場合。
- 同じ患者が1日に2つの予約枠を持つことになる。

**運用の正解**:
- **システム挙動**: 「同じ時間帯」の重複はNGだが、時間がずれていれば同日でも予約可能とする。
- **来院回数**: システムは1回の来院ごとにカウントアップするのか、日単位か？
    - 現状の仕様: 予約ごとにカウント（例: 午前が3回目、夕方が4回目）。実務的にも「施術回数」管理ならこれで正しい。「来院日数」管理なら別途集計が必要。

### 1-5. 遅刻・時間延長への対応 (Late Arrival & Extension)
**状況**:
- 患者が15分遅刻したため、後ろの予約をずらすか、施術時間を短縮するか迫られる。
- 施術中に「延長」を希望され、後ろの枠が空いているので受け入れる場合。

**運用の正解**:
- **システム挙動**: 予約時間の「開始時間」や「所要時間」をドラッグ＆ドロップや編集画面で即座に修正できること。
- **UI要件**: 直感的な時間変更操作。変更時に、後ろの予約と重なってしまう場合の警告（Conflict Warning）が重要。

### 1-6. ダブルブッキングの許容 (Overbooking / Force Booking)
**状況**:
- 予約はいっぱいだが、急患対応や、院長の判断で「少し待ってもらえれば診れるから入れて」と指示が出た場合。
- 物理的なベッド数には余裕がある場合など。

**運用の正解**:
- **システム挙動**:
    - Default: 重複はシステムエラーとしてブロック（現在の実装）。
    - Advanced: 「警告は出すが、管理権限があれば強制的に登録できる（Override）」機能が、将来的に必要になる可能性が高い。
    - **決定事項**: V1.1フェーズでは「絶対ブロック」で安全性を優先するが、運用が回らない場合は緩和策を検討する。

---

## 🏥 2. 受付・来院管理 (Reception Workflow)

### 2-1. 来院チェックイン (Check-in)
**状況**:
- 予約患者が玄関に入ってきた瞬間。
- 「誰が来たか」を確認し、カルテを準備する。

**運用の正解**:
- **システム挙動**: ダッシュボードの「本日の予定」からワンクリックで「来院済み（Checked-in）」ステータスに変更できる。
- **UI要件**: 色が変わる、または「来院中」タブに移動するなどして、待合室に誰がいるか一目で分かるようにする。

### 2-2. 会計・次回の予約 (Checkout & Re-booking)
**状況**:
- 施術が終わり、会計をするタイミングで「次回の予約」を取ることが多い。

**運用の正解**:
- **システム挙動**: カルテ画面や会計画面から、スムーズに「新規予約作成」へ遷移できる導線。
- **自動入力**: 患者IDなどの情報は引き継がれること。
