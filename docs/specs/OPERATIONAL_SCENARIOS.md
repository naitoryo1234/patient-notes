# 🏢 実務運用シナリオ集 (Operational Scenarios - Generic Base)

このドキュメントは、予約・顧客管理システムの「汎用的な運用パターン」を定義したものです。
特定の業態（クリニック、サロン、教室など）に依存せず、共通して発生する実務フローを網羅し、UI/UX設計の基盤とします。

---

## 📅 1. 予約管理 (Appointment Management)

### 1-1. 担当者未定での予約確保 (Tentative Booking)

**状況**  
- 顧客から予約希望が入ったが、対応するスタッフを即座に決定できない（または決定する必要がない）場合。
- 「とりあえず枠だけ確保したい」というニーズ。

**運用の正解**  
- スタッフ割り当てを必須とせず、まずは予約日時と顧客情報だけで成約させる。
- 割り当ては後日、または当日の朝に行う運用を許容する。

**システム挙動**  
- Staff 選択は任意。`未定（Unassigned）` 状態での保存を許可する。
- 未定の予約は、管理画面上で警告色などで強調表示し、手配漏れを防ぐ。

**UI要件**  
- ダッシュボード/管理画面：
  - 「未割り当て（Unassigned）」のアラートを表示。
  - 該当予約を目立つ色（赤など）で表示。
  - アラートクリックで「未割り当てのみ」をフィルタリングできる（実装済み）。

---

### 1-2. 担当者の変更 (Reassignment)

**状況**  
- スタッフの急な欠勤や、シフト変更、顧客からの指名変更などにより、担当者を変更する必要が生じた場合。

**運用の正解**  
- 予約データを作り直すことなく、ドロップダウン操作のみで担当者を入れ替える。
- 変更先のスタッフが「その時間に空いているか」をシステムがチェックする。

**システム挙動**  
- 変更時にダブルブッキング（重複）チェックを行う。
- 重複がある場合はエラーとし、変更をブロックする。

---

### 1-3. 同日複数回利用 (Multiple Visits / Family Booking)

**状況**  
- 同一顧客が、同じ日に時間を空けて2回サービスを受ける場合（例：午前と午後）。
- または、家族やペアで来店し、同一アカウント（代表者）で複数の枠を予約する場合。

**運用の正解**  
- 時間帯が完全に重複していない限り、同一日・同一顧客の複数予約を許可する。
- 「1日に1回しか予約できない」という制限は設けない。

**システム挙動**  
- 開始時間と所要時間が重ならない限り、保存を許可する。
- リスト上では、同日の何回目の利用か（「2回目」など）を表示して区別する。

---

### 1-4. 時間変更・延長 (Rescheduling & Extension)

**状況**  
- 顧客の遅刻による時間ずらしや、コースアップグレードによる所要時間の延長。

**運用の正解**  
- 編集画面から「開始時間」「所要時間」を柔軟に変更できる。
- 変更の結果、後ろの予約と被る場合は警告を出す。

---

## 🏢 2. 受付・来店管理 (Reception / Front Desk)

### 2-1. 来店チェックイン (Check-in / Arrival)

**状況**  
- 予約していた顧客が店舗・施設に到着した。
- 現場スタッフは「誰が待合にいるか」「誰が到着済みか」を即座に把握したい。

**運用の正解**  
- ワンアクションで「到着（Arrived）」ステータスに更新できる。
- 到着済みの顧客は、画面上で視覚的に区別（色変更、バッジ表示）される。

**システム挙動**  
- `arrivedAt` にタイムスタンプを記録。
- 状況に合わせて「到着済み」「施術中」「会計待ち」などのステータスフローへ繋げる（v1.xでは「到着」までをスコープ）。

---

### 2-2. 次回予約の手配 (Re-booking)

**状況**  
- サービス提供後、帰り際に次回の予約を取るフロー。
- 顧客情報を再度検索・入力する手間を省きたい。

**運用の正解**  
- 顧客詳細ページや文脈メニューから「予約作成」を選べば、顧客が選択された状態で予約フォームが開く。

**Implementation Checklist**
- [x] 顧客詳細ページに「予約追加」ボタンを配置。

---

**Terminology Map (用語対応表)**
| Base Term | Clinic | Salon | Generic |
| :--- | :--- | :--- | :--- |
| **Customer** | 患者 (Patient) | お客様 (Guest) | 顧客/Users |
| **Staff** | 施術者/スタッフ | スタイリスト | 担当者 |
| **Service** | 診療/施術 | メニュー/施術 | サービス |
| **Visit** | 来院 | 来店 | 来訪/利用 |
